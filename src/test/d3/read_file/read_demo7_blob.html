<html>  
<head>  
	<meta charset="utf-8">  
	<title>A simple specctrum</title>  
</head> 


<body>  
<input type="file" name="upload" id="upload"/>
<button type="button" id="buttons" data-start="0" data-end="100">Load</button>
<br/>
<textarea name="range" id="range"></textarea>
<textarea name="content" id="content"></textarea>

<script type="text/javascript">
    function readBlob(start, end) {
        var files = document.getElementById('upload').files;
         
        if(!files.length) {
            alert('请选择文件');
            return false;
        }
         
        var file = files[0],
            start = parseInt(start, 10) || 0,
            end = parseInt(end, 10) || (file.size - 1);
     
        console.log("start="+start+",end="+end);
        var r = document.getElementById('range'),
            c = document.getElementById('content');
             
        var reader = new FileReader();
         
        reader.onloadend = function(e) {
            if(this.readyState == FileReader.DONE) {
                c.textContent = this.result;
                r.textContent = "Read bytes: " + (start + 1) + " - " + (end + 1) + " of " + file.size + " bytes";
            }
        };
        var blob;
         
        blob = file.slice(start, end + 1);
        reader.readAsText(blob);
    };
    try {
        document.getElementById('buttons').addEventListener('click', function(e) {
            console.log(e.target);
            if(e.target.tagName.toLowerCase() == 'button') {
                var start = e.target.getAttribute('data-start'),
                    end = e.target.getAttribute('data-end');
                     
                readBlob(start, end);
            }  
        });
    } catch(ex) {
        alert('something error happens!')
    }  





    // var st;
    // window.onload = function() {
    //     /**
    //      * 上传函数
    //      * @param fileInput DOM对象
    //      * @param callback 回调函数
    //      */
    //     var getFileContent = function (fileInput, callback) {
    //         if (fileInput.files && fileInput.files.length > 0 && fileInput.files[0].size > 0) {
    //             //下面这一句相当于JQuery的：var file =$("#upload").prop('files')[0];
    //             var file = fileInput.files[0];
    //             if (window.FileReader) {
    //                 var reader = new FileReader();
    //                 console.log(reader);
    //                 reader.onloadend = function (evt) {
    //                 	console.log(evt);
    //                     if (evt.target.readyState == FileReader.DONE) {
    //                 		console.log(evt.target.result);
    //                         callback(evt.target.result);
    //                     }
    //                 };
    //                 // 包含中文内容用gbk编码
    //                 reader.readAsText(file);
    //             }
    //         }
    //     };

    //     /**
    //      * upload内容变化时载入内容
    //      */
    //     document.getElementById('upload').onchange = function () {
    //         var content = document.getElementById('content');

    //         getFileContent(this, function (str) {
    //             st = str;
    //             content.value = "OK";
    //         });
    //     };
    // };
</script>

</body>  
</html>  